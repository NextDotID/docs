"use strict";(self.webpackChunknext_id_doc=self.webpackChunknext_id_doc||[]).push([[359],{3881:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var r=i(8101);const s={},t=r.createContext(s);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:n},e.children)}},6299:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/kvservice-workflow-3590cff61c71a6e69d03bd07f8cd17c5.png"},9455:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"core-concepts/proof-service/ks-intro","title":"Decentralized Storage, KV Service","description":"While developing the Next.ID, we found that we still need a place to keep some customized data in some cases. However, placing everything on the blockchain wasn\'t a reasonable choice. This led us to create the KV service as a user-friendly tool for storing some customized data. Through cryptographic verification, the KV Service ensures that only the avatar\'s owner can manage (create and modify) its content, while allowing others to read it.","source":"@site/docs/core-concepts/proof-service/kvservice.md","sourceDirName":"core-concepts/proof-service","slug":"/core-concepts/proof-service/ks-intro","permalink":"/core-concepts/proof-service/ks-intro","draft":false,"unlisted":false,"editUrl":"https://github.com/nextdotid/docs/edit/main/docs/core-concepts/proof-service/kvservice.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"ks-intro","title":"Decentralized Storage, KV Service","sidebar_position":3},"sidebar":"docs","previous":{"title":"Web3 Auth, Auth Service","permalink":"/core-concepts/proof-service/as-intro"},"next":{"title":"Introduction","permalink":"/core-concepts/relation-service/rs-intro"}}');var s=i(5105),t=i(3881);const o={id:"ks-intro",title:"Decentralized Storage, KV Service",sidebar_position:3},a=void 0,c={},d=[{value:"How it works",id:"how-it-works",level:2},{value:"Work Flow for writing",id:"work-flow-for-writing",level:3},{value:"Query data",id:"query-data",level:3},{value:"Design",id:"design",level:3},{value:"Notice",id:"notice",level:3},{value:"Use Case - as a persistence storage",id:"use-case---as-a-persistence-storage",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["While developing the Next.ID, we found that we still need a place to keep some customized data in some cases. However, placing everything on the blockchain wasn't a reasonable choice. This led us to create the KV service as a user-friendly tool for storing some customized data. Through cryptographic verification, the ",(0,s.jsx)(n.code,{children:"KV Service"})," ensures that only the avatar's owner can manage (create and modify) its content, while allowing others to read it."]}),"\n",(0,s.jsx)(n.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"KV Service"})," can store any valid JSON object data. There are serval APIs for reading and writing the data."]}),"\n",(0,s.jsx)(n.h3,{id:"work-flow-for-writing",children:"Work Flow for writing"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(6299).A+"",width:"1080",height:"1080"})}),"\n",(0,s.jsx)(n.p,{children:"The generation signature and verification steps to guarantee the modification request is from the owner of Avatar."}),"\n",(0,s.jsx)(n.h3,{id:"query-data",children:"Query data"}),"\n",(0,s.jsxs)(n.p,{children:["After writing the data, everyone can get it via API.See ",(0,s.jsx)(n.a,{href:"/rest-api/kvservice-api#query",children:"GET /v1/kv"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"design",children:"Design"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Each user has ",(0,s.jsx)(n.code,{children:"1 + N"})," namespaces\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/introduction/how-it-works#avatars-in-nextid",children:"Avatar"})," itself has a namespace (",(0,s.jsx)(n.code,{children:'platform == "nextid" && identity == "0xAVATAR_PUBLIC_KEY"'}),")","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["There's no limitation that ",(0,s.jsx)(n.a,{href:"/introduction/how-it-works#avatars-in-nextid",children:"Avatar"})," should be used in ",(0,s.jsx)(n.a,{href:"ps-intro",children:"ProofService"})," once."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Each ",(0,s.jsx)(n.a,{href:"./ps-intro#data-structure",children:"binding record"})," (in ",(0,s.jsx)(n.a,{href:"ps-intro",children:"ProofService"}),") of each ",(0,s.jsx)(n.a,{href:"/introduction/how-it-works#avatars-in-nextid",children:"Avatar"})," has a namespace.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Value of ",(0,s.jsx)(n.code,{children:"platform"})," and ",(0,s.jsx)(n.code,{children:"identity"})," are the same as ",(0,s.jsx)(n.a,{href:"./ps-intro#supported-platform",children:"supported platforms"})," in ProofService."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/rest-api/kvservice-api#query",children:"Query data"}),": public, only need to specify ",(0,s.jsx)(n.code,{children:"avatar"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/rest-api/kvservice-api#payload",children:"Write data"}),": A patch followed ",(0,s.jsx)(n.a,{href:"https://www.rfc-editor.org/rfc/rfc7396",children:"RFC 7396"})," standard."]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:"A glimpse of RFC7396"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'// Assume current data is:\n{\n  "a": {\n    "b": [2, 3, 4, "test"]\n  },\n  "c": "Hello"\n}\n\n// If this patch is submitted:\n{ "a": { "b": null, "new_key": true }, "c": "KVService" }\n\n// Then patched data will become:\n{\n  "a": {\n    "new_key": true\n  },\n  "c": "KVService"\n}\n// Notice: nested modification of Array value is not supported.\n//         Replace the whole Array with new value instead.\n'})})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"notice",children:"Notice"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Each app should use its "package name" as its own namespace, to ensure other apps are not infected by your modification.'}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For example, I as a developer, identify my app as ",(0,s.jsx)(n.code,{children:"io.mask.web3-profile-plugin"}),","]}),"\n",(0,s.jsxs)(n.p,{children:["Then I should make the modifications under ",(0,s.jsx)(n.code,{children:'{ "io.mask.web3-profile-plugin": .... }'})," key."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Theoretically, there is no size limitation for data. FairUse\u2122\ufe0f, please."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["If you want to store data bigger than a string can handle, consider ",(0,s.jsx)(n.a,{href:"https://www.arweave.org",children:"Arweave"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"use-case---as-a-persistence-storage",children:"Use Case - as a persistence storage"}),"\n",(0,s.jsxs)(n.p,{children:["You can use ",(0,s.jsx)(n.code,{children:"KV Service"})," to store the data that needs cross-session persistence."]}),"\n",(0,s.jsx)(n.p,{children:"For example, you can store the user's avatar, nick name, bio, show/hide status of NFT list, or order of these contents, under your web3 app's scenarios."}),"\n",(0,s.jsxs)(n.p,{children:["Using ",(0,s.jsx)(n.code,{children:"KV Service"})," gives you some benefits:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The change made by the user is verifiable by other user/applications, aka platform-independent. No one (except the user himself) can change the data without a valid signature."}),"\n",(0,s.jsxs)(n.li,{children:["The data is stored in a decentralized way, no matter where this data is actually stored. User always has a choice to move their data to other (or self-hosted) platforms.","\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:'The actual "migration" function is still under development.'}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);